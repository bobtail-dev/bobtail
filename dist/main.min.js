!function(e,t){if("function"==typeof define&&define.amd)define("bobtail",["exports","bobtail-rx","jquery","underscore","es5-shim","es6-shim"],t);else if("undefined"!=typeof exports)t(exports,require("bobtail-rx"),require("jquery"),require("underscore"),require("es5-shim"),require("es6-shim"));else{var r={exports:{}};t(r.exports,e.rx,e.$,e._,e.es5Shim,e.es6Shim),e.rx=r.exports}}(this,function(e,t,r,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.rxt=void 0,Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[r]}})});var u=a(r),l=a(n),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(t),c=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=void 0,d=void 0;u.default.fn.rx=function(e){var t=this,r=this.data("rx-map");return null==r&&this.data("rx-map",r=Object.create(null)),e in r?r[e]:r[e]=function(){switch(e){case"focused":var r=f.cell(t.is(":focus"));return t.focus(function(){return r.set(!0)}),t.blur(function(){return r.set(!1)}),r;case"val":var n=f.cell(t.val());return t.change(function(){return n.set(t.val())}),t.on("input",function(){return n.set(t.val())}),n;case"checked":var a=f.cell(t.is(":checked"));return t.change(function(){return a.set(t.is(":checked"))}),a;default:throw new Error("Unknown reactive property type")}}()};var m=function(e){return(e instanceof f.ObsCell||e instanceof f.ObsArray||l.default.isArray(e))&&(e=f.flatten(e)),e},h={};h.enabled=!1,h.onElementChildrenChanged=new f.Ev,h.onElementAttrsChanged=new f.Ev;var p=function e(t){i(this,e),this.html=t},y=["blur","change","click","dblclick","error","focus","focusin","focusout","hover","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","ready","resize","scroll","select","submit","toggle","unload"],v=["click"],g={init:function(e,t){return t.call(e)}},b=!0,w=!1,A=void 0;try{for(var x,k=Array.from(y)[Symbol.iterator]();!(b=(x=k.next()).done);b=!0)!function(e){g[e]=function(t,r){return t instanceof SVGElement&&Array.from(v).includes(e)?t.addEventListener(e,r):t[e](function(e){return r.call(t,e)})}}(x.value)}catch(e){w=!0,A=e}finally{try{!b&&k.return&&k.return()}finally{if(w)throw A}}var S=["async","autofocus","checked","location","multiple","readOnly","selected","selectedIndex","tagName","nodeName","nodeType","ownerDocument","defaultChecked","defaultSelected"],C=l.default.object(function(){var e=[],t=!0,r=!1,n=void 0;try{for(var a,o=Array.from(S)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)d=a.value,e.push([d,null])}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}return e}()),E=function(e,t,r){return e instanceof SVGElement?e.setAttribute(t,r):"value"===t?e.val(r):t in C?e.prop(t,r):e.attr(t,r)},j=function(e,t,r,n){return null==n&&(n=l.default.identity),r instanceof f.ObsCell?f.autoSub(r.onSet,function(){var r=Array.from(arguments.length<=0?void 0:arguments[0]),a=c(r,2),o=(a[0],a[1]);if(E(e,t,n(o)),h.enabled)return h.onElementAttrsChanged.pub({$element:e,attr:t})}):E(e,t,n(r))},O=function(e,t){return null==e&&null==t?[{},null]:e instanceof Object&&null!=t?[e,t]:null==t&&l.default.isString(e)||l.default.isNumber(e)||e instanceof Element||e instanceof SVGElement||e instanceof p||e instanceof u.default||l.default.isArray(e)||e instanceof f.ObsCell||e instanceof f.ObsArray||e instanceof f.ObsSet?[{},e]:[e,null]},_=function(e){return function(){var t=[],r=!0,n=!1,a=void 0;try{for(var o,i=Array.from(e)[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var f=o.value;if(null!=f)if(l.default.isString(f)||l.default.isNumber(f))t.push(document.createTextNode(f));else if(f instanceof Element||f instanceof SVGElement)t.push(f);else if(f instanceof p){var c=(0,u.default)(f.html);if(1!==c.length)throw new Error("RawHtml must wrap a single element");t.push(c[0])}else{if(!(f instanceof u.default))throw new Error("Unknown element type in array: "+f.constructor.name+" (must be string, number, Element, RawHtml, or jQuery objects)");if(1!==f.length)throw new Error("jQuery object must wrap a single element");t.push(f[0])}else t.push(void 0)}}catch(e){n=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw a}}return t}()},q=function e(t,r){if(t.html&&t.html(""),null!=r){if(l.default.isArray(r)){var n=_(r);t.append(n);return n}if(l.default.isString(r)||l.default.isNumber(r)||r instanceof Element||r instanceof SVGElement||r instanceof p||r instanceof u.default)return e(t,[r]);throw new Error("Unknown type for element contents: "+r.constructor.name+" (accepted types: string, number, Element, RawHtml, jQuery object of single element, or array of the aforementioned)")}};s=function(e){return function(t,r){var n=Array.from(O(t,r)),a=c(n,2),o=a[0],i=a[1];i=m(i);var s=(0,u.default)("<"+e+"/>"),d=l.default.omit(o,l.default.keys(g));for(var p in d){var y=d[p];j(s,p,y)}null!=i&&(i instanceof f.ObsArray?f.autoSub(i.indexed().onChangeCells,function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),t=c(e,3),r=t[0],n=t[1],a=t[2];s.contents().slice(r,r+n.length).remove();var o=_(a.map(function(){var e=void 0,t=Array.from(arguments.length<=0?void 0:arguments[0]),r=c(t,2);return e=r[0],r[1],f.snap(function(){return e.get()})}));return r===s.contents().length?s.append(o):s.contents().eq(r).before(o),h.enabled&&(n.length||o.length)&&h.onElementChildrenChanged.pub({$element:s,type:"childrenUpdated",added:o,removed:_(n.map(function(e){return f.snap(function(){return e.get()})}))}),function(){var e=[],t=!0,r=!1,n=void 0;try{for(var i,u=Array.from(a)[Symbol.iterator]();!(t=(i=u.next()).done);t=!0){var l=c(i.value,2),d=l[0],m=l[1];e.push(function(e,t){return f.autoSub(e.onSet,f.skipFirst(function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=c(e,2),n=(r[0],r[1]),a=f.snap(function(){return t.get()});if(o=_([n]),s.contents().eq(a).replaceWith(o),h.enabled)return h.onElementChildrenChanged.pub({$element:s,type:"childrenUpdated",updated:o})}))}(d,m))}}catch(e){r=!0,n=e}finally{try{!t&&u.return&&u.return()}finally{if(r)throw n}}return e}()}):q(s,i));for(var v in o)v in g&&g[v](s,o[v],o,i);return s}};var N=["html","head","title","base","link","meta","style","script","noscript","body","body","section","nav","article","aside","h1","h2","h3","h4","h5","h6","h1","h6","header","footer","address","main","main","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","dd","figure","figcaption","div","a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr","ins","del","img","iframe","embed","object","param","object","video","audio","source","video","audio","track","video","audio","canvas","map","area","area","map","svg","math","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","fieldset","legend","fieldset","label","input","button","select","datalist","optgroup","option","select","datalist","textarea","keygen","output","progress","meter","details","summary","details","menuitem","menu"],G=["a","altglyph","altglyphdef","altglyphitem","animate","animatecolor","animatemotion","animatetransform","circle","clippath","color-profile","cursor","defs","desc","ellipse","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialgradient","rect","script","set","stop","style","svg","switch","symbol","text","textpath","title","tref","tspan","use","view","vkern"],V=function e(t,r){for(;t.firstChild;)t.removeChild(t.firstChild);if(l.default.isArray(r)){var n=_(r);return Array.from(n).map(function(e){return t.appendChild(e)})}if(l.default.isString(r)||r instanceof SVGElement)return e(t,[r]);throw console.error("updateSVGContents",t,r),"Must wrap contents "+r+" as array or string"},$=function(e){return function(t,r){var n=Array.from(O(t,r)),a=c(n,2),o=a[0],i=a[1],u=document.createElementNS("http://www.w3.org/2000/svg",e),s=l.default.omit(o,l.default.keys(g));for(var d in s){var m=s[d];j(u,d,m)}null!=i&&(i instanceof f.ObsArray?i.onChange.sub(function(){for(var e=void 0,t=Array.from(arguments.length<=0?void 0:arguments[0]),r=c(t,3),n=r[0],a=r[1],o=r[2],i=0,l=a.length,f=0<=l;f?i<l:i>l;f?i++:i--)u.removeChild(u.childNodes[n]);var s=_(o);return n===u.childNodes.length?function(){var t=[],r=!0,n=!1,a=void 0;try{for(var o,i=Array.from(s)[Symbol.iterator]();!(r=(o=i.next()).done);r=!0)e=o.value,t.push(u.appendChild(e))}catch(e){n=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw a}}return t}():function(){var t=[],r=!0,a=!1,o=void 0;try{for(var i,l=Array.from(s)[Symbol.iterator]();!(r=(i=l.next()).done);r=!0)e=i.value,t.push(u.childNodes[n].insertBefore(e))}catch(e){a=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}return t}()}):i instanceof f.ObsCell?i.onSet.sub(function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),t=c(e,2),r=(t[0],t[1]);return V(u,r)}):V(u,i));for(var h in o)h in g&&g[h](u,o[h],o,i);return u}},H=(N=l.default.object(N.map(function(e){return[e,s(e)]}))).input,M=function(e,t){return H(l.default.extend({type:e},t))};H.color=function(e){return M("color",e)},H.date=function(e){return M("date",e)},H.datetime=function(e){return M("datetime",e)},H.datetimeLocal=function(e){return M("datetime-local",e)},H.email=function(e){return M("email",e)},H.file=function(e){return M("file",e)},H.hidden=function(e){return M("hidden",e)},H.image=function(e){return M("image",e)},H.month=function(e){return M("month",e)},H.number=function(e){return M("number",e)},H.password=function(e){return M("password",e)},H.range=function(e){return M("range",e)},H.reset=function(e){return M("reset",e)},H.search=function(e){return M("search",e)},H.submit=function(e){return M("submit",e)},H.tel=function(e){return M("tel",e)},H.text=function(e){return M("text",e)},H.time=function(e){return M("time",e)},H.url=function(e){return M("url",e)},H.week=function(e){return M("week",e)};var P=function(e){return e._oldProp=e.prop,e.prop=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=e._oldProp.apply(e,o(Array.from(r||[])));return r.length>1&&"checked"===r[0]&&e.rx("checked").set(e.prop("checked")),a},e};H.checkbox=function(e){return P(H(l.default.extend({type:"checkbox"},e)))},H.radio=function(e){return P(H(l.default.extend({type:"radio"},e)))},G=l.default.object(G.map(function(e){return[e,$(e)]}));var U=function(e){return new p(e)},R=u.default.trim;g.style=function(e,t){var r=t instanceof f.ObsCell;return f.autoSub(f.cast(t).onSet,function(){var t=Array.from(arguments.length<=0?void 0:arguments[0]),n=c(t,2),a=(n[0],n[1]);if(null==a||l.default.isString(a)?E(e,"style",a):e.removeAttr("style").css(a),r&&h.enabled)return h.onElementAttrsChanged.pub({$element:e,attr:"style"})})};var T=function(e){return(0,l.default)(e).chain().flatten().compact().value().join(" ").replace(/\s+/," ").trim()};g.class=function(e,t){return j(e,"class",t,function(e){return l.default.isString(e)?e:T(e)})};e.rxt={events:h,RawHtml:p,specialAttrs:g,mktag:s,svg_mktag:$,tags:N,svg_tags:G,rawHtml:U,specialChar:function(e,t){return null==t&&(t="span"),U("<"+t+">&"+e+";</"+t+">")},unicodeChar:function(e,t){return null==t&&(t="span"),U("<"+t+">\\u"+e+";</"+t+">")},trim:R,dasherize:function(e){return R(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},smushClasses:T}});