(function(){var e=[].indexOf||function(e){for(var n=0,t=this.length;n<t;n++)if(n in this&&this[n]===e)return n;return-1},n=[].slice;!function(e,n){var t,r,i,o;if(i=["bobtail-rx","jquery"],null!=("undefined"!=typeof define&&null!==define?define.amd:void 0))return define(i,n);if(null!=("undefined"!=typeof module&&null!==module?module.exports:void 0))return o=require("bobtail-rx"),t=require("jquery"),r=require("underscore"),require("es5-shim"),require("es6-shim"),module.exports=n(o,r,t);if(null!=e._&&null!=e.$&&e.rx)return n(e.rx,e._,e.$);throw"Dependencies are not met for bobtail: "+[null==e.rx?"bobtail-rx":void 0,null==e._?"_":void 0,null==e.$?"$":void 0].filter(function(e){return e}).join(",")+" not found"}(this,function(t,r,i){var o,u,a,l,s,c,f,d,m,h,p,g,b,v,y,w,k,x,C,E,S,j,A,O;i.fn.rx=function(e){var n,r,i,o;return null==(i=this.data("rx-map"))&&this.data("rx-map",i=Object.create(null)),e in i?i[e]:i[e]=function(){switch(e){case"focused":return r=t.cell(this.is(":focus")),this.focus(function(){return r.set(!0)}),this.blur(function(){return r.set(!1)}),r;case"val":return o=t.cell(this.val()),this.change(function(e){return function(){return o.set(e.val())}}(this)),this.on("input",function(e){return function(){return o.set(e.val())}}(this)),o;case"checked":return n=t.cell(this.is(":checked")),this.change(function(e){return function(){return n.set(e.is(":checked"))}}(this)),n;default:throw new Error("Unknown reactive property type")}}.call(this)},m=function(e){return(e instanceof t.ObsCell||e instanceof t.ObsArray||r.isArray(e))&&(e=t.flatten(e)),e},(b={}).events={},b.events.enabled=!1,b.events.onElementChildrenChanged=new t.Ev,b.events.onElementAttrsChanged=new t.Ev,o=b.RawHtml=function(){return function(e){this.html=e}}(),a=["blur","change","click","dblclick","error","focus","focusin","focusout","hover","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","ready","resize","scroll","select","submit","toggle","unload"],k=["click"],w=b.specialAttrs={init:function(e,n){return n.call(e)}},l=function(n){return w[n]=function(t,r){return t instanceof SVGElement&&e.call(k,n)>=0?t.addEventListener(n,r):t[n](function(e){return r.call(t,e)})}};for(c=0,f=a.length;c<f;c++)l(a[c]);return g=["async","autofocus","checked","location","multiple","readOnly","selected","selectedIndex","tagName","nodeName","nodeType","ownerDocument","defaultChecked","defaultSelected"],p=r.object(function(){var e,n,t;for(t=[],e=0,n=g.length;e<n;e++)h=g[e],t.push([h,null]);return t}()),y=function(e,n,t){return e instanceof SVGElement?e.setAttribute(n,t):"value"===n?e.val(t):n in p?e.prop(n,t):e.attr(n,t)},v=function(e,n,i,o){return null==o&&(o=r.identity),i instanceof t.ObsCell?t.autoSub(i.onSet,function(t){var r;if(t[0],r=t[1],y(e,n,o(r)),b.events.enabled)return b.events.onElementAttrsChanged.pub({$element:e,attr:n})}):y(e,n,o(i))},d=function(e,n){return null==e&&null==n?[{},null]:e instanceof Object&&null!=n?[e,n]:null==n&&r.isString(e)||r.isNumber(e)||e instanceof Element||e instanceof SVGElement||e instanceof o||e instanceof i||r.isArray(e)||e instanceof t.ObsCell||e instanceof t.ObsArray||e instanceof t.ObsSet?[{},e]:[e,null]},j=function(e){var n,t,u,a,l;for(l=[],t=0,u=e.length;t<u;t++)if(null!=(n=e[t]))if(r.isString(n)||r.isNumber(n))l.push(document.createTextNode(n));else if(n instanceof Element||n instanceof SVGElement)l.push(n);else if(n instanceof o){if(1!==(a=i(n.html)).length)throw new Error("RawHtml must wrap a single element");l.push(a[0])}else{if(!(n instanceof i))throw new Error("Unknown element type in array: "+n.constructor.name+" (must be string, number, Element, RawHtml, or jQuery objects)");if(1!==n.length)throw new Error("jQuery object must wrap a single element");l.push(n[0])}else l.push(void 0);return l},A=function(e,n){var t;if(e.html&&e.html(""),null!=n){if(r.isArray(n))return t=j(n),e.append(t),t;if(r.isString(n)||r.isNumber(n)||n instanceof Element||n instanceof SVGElement||n instanceof o||n instanceof i)return A(e,[n]);throw new Error("Unknown type for element contents: "+n.constructor.name+" (accepted types: string, number, Element, RawHtml, jQuery object of single element, or array of the aforementioned)")}},b.mktag=function(e){return function(n,o){var u,a,l,s,c,f,h,p;u=(f=d(n,o))[0],a=f[1],a=m(a),l=i("<"+e+"/>"),h=r.omit(u,r.keys(w));for(c in h)p=h[c],v(l,c,p);null!=a&&(a instanceof t.ObsArray?t.autoSub(a.indexed().onChangeCells,function(e){var n,r,i,o,u,a,s,c,f,d;for(o=e[0],c=e[1],n=e[2],l.contents().slice(o,o+c.length).remove(),d=j(n.map(function(e){var n;return n=e[0],e[1],t.snap(function(){return n.get()})})),o===l.contents().length?l.append(d):l.contents().eq(o).before(d),b.events.enabled&&(c.length||d.length)&&b.events.onElementChildrenChanged.pub({$element:l,type:"childrenUpdated",added:d,removed:j(c.map(function(e){return t.snap(function(){return e.get()})}))}),f=[],u=0,a=n.length;u<a;u++)r=(s=n[u])[0],i=s[1],f.push(function(e,n){return t.autoSub(e.onSet,t.skipFirst(function(e){var r,i;if(e[0],i=e[1],r=t.snap(function(){return n.get()}),d=j([i]),l.contents().eq(r).replaceWith(d),b.events.enabled)return b.events.onElementChildrenChanged.pub({$element:l,type:"childrenUpdated",updated:d})}))}(r,i));return f}):A(l,a));for(s in u)s in w&&w[s](l,u[s],u,a);return l}},S=["html","head","title","base","link","meta","style","script","noscript","body","body","section","nav","article","aside","h1","h2","h3","h4","h5","h6","h1","h6","header","footer","address","main","main","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","dd","figure","figcaption","div","a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr","ins","del","img","iframe","embed","object","param","object","video","audio","source","video","audio","track","video","audio","canvas","map","area","area","map","svg","math","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","fieldset","legend","fieldset","label","input","button","select","datalist","optgroup","option","select","datalist","textarea","keygen","output","progress","meter","details","summary","details","menuitem","menu"],x=["a","altglyph","altglyphdef","altglyphitem","animate","animatecolor","animatemotion","animatetransform","circle","clippath","color-profile","cursor","defs","desc","ellipse","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialgradient","rect","script","set","stop","style","svg","switch","symbol","text","textpath","title","tref","tspan","use","view","vkern"],O=function(e,n){for(var t,i,o,u,a;e.firstChild;)e.removeChild(e.firstChild);if(r.isArray(n)){for(u=[],t=0,i=(a=j(n)).length;t<i;t++)o=a[t],u.push(e.appendChild(o));return u}if(r.isString(n)||n instanceof SVGElement)return O(e,[n]);throw console.error("updateSVGContents",e,n),"Must wrap contents "+n+" as array or string"},b.svg_mktag=function(e){return function(n,i){var o,u,a,l,s,c,f,m;o=(c=d(n,i))[0],u=c[1],a=document.createElementNS("http://www.w3.org/2000/svg",e),f=r.omit(o,r.keys(w));for(s in f)m=f[s],v(a,s,m);null!=u&&(u instanceof t.ObsArray?u.onChange.sub(function(e){var n,t,r,i,o,u,l,s,c,f,d,m,h;for(t=e[0],f=e[1],n=e[2],r=0,c=f.length;0<=c?r<c:r>c;0<=c?++r:--r)a.removeChild(a.childNodes[t]);if(h=j(n),t===a.childNodes.length){for(d=[],u=0,i=h.length;u<i;u++)l=h[u],d.push(a.appendChild(l));return d}for(m=[],s=0,o=h.length;s<o;s++)l=h[s],m.push(a.childNodes[t].insertBefore(l));return m}):u instanceof t.ObsCell?u.onSet.sub(function(e){var n;return e[0],n=e[1],O(a,n)}):O(a,u));for(l in o)l in w&&w[l](a,o[l],o,u);return a}},b.tags=r.object(function(){var e,n,t;for(t=[],e=0,n=S.length;e<n;e++)E=S[e],t.push([E,b.mktag(E)]);return t}()),s=b.tags.input,u=function(e,n){return s(r.extend({type:e},n))},s.color=function(e){return u("color",e)},s.date=function(e){return u("date",e)},s.datetime=function(e){return u("datetime",e)},s.datetimeLocal=function(e){return u("datetime-local",e)},s.email=function(e){return u("email",e)},s.file=function(e){return u("file",e)},s.hidden=function(e){return u("hidden",e)},s.image=function(e){return u("image",e)},s.month=function(e){return u("month",e)},s.number=function(e){return u("number",e)},s.password=function(e){return u("password",e)},s.range=function(e){return u("range",e)},s.reset=function(e){return u("reset",e)},s.search=function(e){return u("search",e)},s.submit=function(e){return u("submit",e)},s.tel=function(e){return u("tel",e)},s.text=function(e){return u("text",e)},s.time=function(e){return u("time",e)},s.url=function(e){return u("url",e)},s.week=function(e){return u("week",e)},C=function(e){return e._oldProp=e.prop,e.prop=function(){var t,r;return t=1<=arguments.length?n.call(arguments,0):[],r=e._oldProp.apply(e,t),t.length>1&&"checked"===t[0]&&e.rx("checked").set(e.prop("checked")),r},e},s.checkbox=function(e){return C(s(r.extend({type:"checkbox"},e)))},s.radio=function(e){return C(s(r.extend({type:"radio"},e)))},b.svg_tags=r.object(function(){var e,n,t;for(t=[],e=0,n=x.length;e<n;e++)E=x[e],t.push([E,b.svg_mktag(E)]);return t}()),b.rawHtml=function(e){return new o(e)},b.specialChar=function(e,n){return null==n&&(n="span"),b.rawHtml("<"+n+">&"+e+";</"+n+">")},b.unicodeChar=function(e,n){return null==n&&(n="span"),b.rawHtml("<"+n+">\\u"+e+";</"+n+">")},b.importTags=function(e){return function(n){return r(null!=n?n:e).extend(b.tags)}}(this),b.cast=function(e,n){return null==n&&(n="cell"),console.warn("Warning: rx.rxt.cast is deprecated. Use rx.cast instead."),t.cast(e,n)},b.trim=i.trim,b.dasherize=function(e){return b.trim(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},b.cssify=function(e){var n,t;return console.warn("cssify is deprecated; set the `style` property directly to a JSON object."),function(){var i;i=[];for(n in e)null!=(t=e[n])&&i.push(b.dasherize(n)+": "+(r.isNumber(t)?t+"px":t)+";");return i}().join(" ")},w.style=function(e,n){var i;return i=n instanceof t.ObsCell,t.autoSub(t.cast(n).onSet,function(n){var t;if(n[0],null==(t=n[1])||r.isString(t)?y(e,"style",t):e.removeAttr("style").css(t),i&&b.events.enabled)return b.events.onElementAttrsChanged.pub({$element:e,attr:"style"})})},b.smushClasses=function(e){return r(e).chain().flatten().compact().value().join(" ").replace(/\s+/," ").trim()},w.class=function(e,n){return v(e,"class",n,function(e){return r.isString(e)?e:b.smushClasses(e)})},t.rxt=b,t})}).call(this);