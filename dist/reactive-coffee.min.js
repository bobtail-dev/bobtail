(function(){var a,b=[].slice,c=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},d={}.hasOwnProperty,e=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha;if(W={},L=0,K=function(){return L+=1},R=function(a,b){var c;if(!(b in a))throw new Error("object has no key "+b);return c=a[b],delete a[b],c},I=function(a,b){var c;return c=a.get(b),a.delete(b),c},N=function(a,b,c){var d,e,f,g;for(d=e=0,f=a.length;e<f;d=++e)if(g=a[d],c(g)&&(b-=1)<0)return[g,d];return[null,-1]},function(a,b){return N(a,0,b)},J=function(b){var c,d,e,f,g,h;if(null==b&&(b=[]),f=null!=Object.create?Object.create(null):{},a.isArray(b))for(c=0,e=b.length;c<e;c++)g=b[c],d=g[0],h=g[1],f[d]=h;else for(d in b)h=b[d],f[d]=h;return f},_=function(a){var b,c,d,e;for(d=0,b=0,c=a.length;b<c;b++)e=a[b],d+=e;return d},h=W.DepMgr=function(){function a(){this.uid2src={},this.buffering=0,this.buffer=[]}return a.prototype.sub=function(a,b){return this.uid2src[a]=b},a.prototype.unsub=function(a){return R(this.uid2src,a)},a.prototype.transaction=function(a){var b,c,d,e;this.buffering+=1;try{e=a()}finally{if(this.buffering-=1,0===this.buffering){for(d=this.buffer,b=0,c=d.length;b<c;b++)d[b]();this.buffer=[]}}return e},a}(),W._depMgr=z=new h,j=W.Ev=function(){function a(a){this.inits=a,this.subs=J()}return a.prototype.sub=function(a){var b,c,d,e,f;if(f=K(),null!=this.inits)for(e=this.inits(),c=0,d=e.length;c<d;c++)b=e[c],a(b);return this.subs[f]=a,z.sub(f,this),f},a.prototype.pub=function(a){var b,c,d,e;if(z.buffering)return z.buffer.push(function(b){return function(){return b.pub(a)}}(this));c=this.subs,d=[];for(e in c)b=c[e],d.push(b(a));return d},a.prototype.unsub=function(a){return R(this.subs,a),z.unsub(a,this)},a.prototype.scoped=function(a,b){var c;c=this.sub(a);try{return b()}finally{this.unsub(c)}},a}(),W.skipFirst=function(a){var c;return c=!0,function(){var d;return d=1<=arguments.length?b.call(arguments,0):[],c?c=!1:a.apply(null,d)}},r=W.Recorder=function(){function b(){this.stack=[],this.isMutating=!1,this.isIgnoring=!1,this.hidingMutationWarnings=!1,this.onMutationWarning=new j}return b.prototype.record=function(b,c){var d,e;this.stack.length>0&&!this.isMutating&&a(this.stack).last().addNestedBind(b),this.stack.push(b),e=this.isMutating,this.isMutating=!1,d=this.isIgnoring,this.isIgnoring=!1;try{return c()}finally{this.isIgnoring=d,this.isMutating=e,this.stack.pop()}},b.prototype.sub=function(b){var c;if(this.stack.length>0&&!this.isIgnoring)return c=a(this.stack).last(),b(c)},b.prototype.addCleanup=function(b){if(this.stack.length>0)return a(this.stack).last().addCleanup(b)},b.prototype.hideMutationWarnings=function(a){var b;b=this.hidingMutationWarnings,this.hidingMutationWarnings=!0;try{return a()}finally{this.hidingMutationWarnings=b}},b.prototype.fireMutationWarning=function(){return console.warn("Mutation to observable detected during a bind context"),this.onMutationWarning.pub(null)},b.prototype.mutating=function(a){var b;this.stack.length>0&&!this.hidingMutationWarnings&&this.fireMutationWarning(),b=this.isMutating,this.isMutating=!0;try{return a()}finally{this.isMutating=b}},b.prototype.ignoring=function(a){var b;b=this.isIgnoring,this.isIgnoring=!0;try{return a()}finally{this.isIgnoring=b}},b}(),W._recorder=V=new r,W.hideMutationWarnings=function(a){return V.hideMutationWarnings(a)},W.asyncBind=x=function(a,b){var c;return c=new g(b,a),c.refresh(),c},W.promiseBind=function(a,b){return x(a,function(){return this.record(b).done(function(a){return function(b){return a.done(b)}}(this))})},W.bind=y=function(a){return x(null,function(){return this.done(this.record(a))})},W.lagBind=function(a,b,c){var d;return d=null,x(b,function(){return null!=d&&clearTimeout(d),d=setTimeout(function(a){return function(){return a.done(a.record(c))}}(this),a)})},W.postLagBind=function(a,b){var c;return c=null,x(a,function(){var a,d,e;return d=this.record(b),e=d.val,a=d.ms,null!=c&&clearTimeout(c),c=setTimeout(function(a){return function(){return a.done(e)}}(this),a)})},W.snap=function(a){return V.ignoring(a)},W.onDispose=function(a){return V.addCleanup(a)},W.autoSub=function(a,b){var c;return c=a.sub(b),W.onDispose(function(){return a.unsub(c)}),c},n=W.ObsCell=function(){function a(a){var b;this.x=a,this.x=null!=(b=this.x)?b:null,this.onSet=new j(function(a){return function(){return[[null,a.x]]}}(this))}return a.prototype.get=function(){return V.sub(function(a){return function(b){return W.autoSub(a.onSet,function(){return b.refresh()})}}(this)),this.x},a}(),t=W.SrcCell=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.set=function(a){return V.mutating(function(b){return function(){var c;if(b.x!==a)return c=b.x,b.x=a,b.onSet.pub([c,a]),c}}(this))},b}(n),g=W.DepCell=function(a){function b(a,c){this.body=a,b.__super__.constructor.call(this,null!=c?c:null),this.refreshing=!1,this.nestedBinds=[],this.cleanups=[]}return c(b,a),b.prototype.refresh=function(){var a,b,c,d,e,f;if(!this.refreshing)return c=this.x,d=function(a){return function(b){return a.x=b,a.onSet.pub([c,a.x])}}(this),e=!1,f=null,b=!1,a={record:function(c){return function(g){var h;if(!c.refreshing){if(c.disconnect(),e)throw new Error("this refresh has already recorded its dependencies");c.refreshing=!0,e=!0;try{h=V.record(c,function(){return g.call(a)})}finally{c.refreshing=!1}return b&&d(f),h}}}(this),done:function(a){return function(e){if(c!==e)return a.refreshing?(b=!0,f=e):d(e)}}(this)},this.body.call(a)},b.prototype.disconnect=function(){var a,b,c,d,e,f,g;for(f=this.cleanups,a=0,c=f.length;a<c;a++)f[a]();for(g=this.nestedBinds,b=0,d=g.length;b<d;b++)e=g[b],e.disconnect();return this.nestedBinds=[],this.cleanups=[]},b.prototype.addNestedBind=function(a){return this.nestedBinds.push(a)},b.prototype.addCleanup=function(a){return this.cleanups.push(a)},b}(n),m=W.ObsArray=function(){function a(a,b){this.cells=null!=a?a:[],this.diff=null!=b?b:W.basicDiff(),this.onChange=new j(function(a){return function(){return[[0,[],W.snap(function(){var b,c,d,e,f;for(d=a.cells,e=[],b=0,c=d.length;b<c;b++)f=d[b],e.push(f.get());return e})]]}}(this)),this.onChangeCells=new j(function(a){return function(){return[[0,[],a.cells]]}}(this)),this.indexed_=null}return a.prototype.all=function(){var a,b,c,d,e;for(V.sub(function(a){return function(b){return W.autoSub(a.onChange,function(){return b.refresh()})}}(this)),c=this.cells,d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(e.get());return d},a.prototype.raw=function(){return this.all()},a.prototype.rawCells=function(){return this.cells},a.prototype.at=function(a){var b;return V.sub(function(b){return function(c){return W.autoSub(b.onChange,function(b){var d,e,f;if(e=b[0],f=b[1],d=b[2],e<=a&&f.length!==d.length&&c.refresh(),f.length===d.length&&a<=e+f.length)return c.refresh()})}}(this)),null!=(b=this.cells[a])?b.get():void 0},a.prototype.length=function(){return V.sub(function(a){return function(b){return W.autoSub(a.onChangeCells,function(a){var c,d;if(a[0],d=a[1],c=a[2],d.length!==c.length)return b.refresh()})}}(this)),this.cells.length},a.prototype.map=function(a){var b;return b=new l,W.autoSub(this.onChangeCells,function(c){return function(c){var d,e,f,g,h,i,j,k;for(f=c[0],k=c[1],d=c[2],j=b.cells.slice(f,f+k.length),g=0,h=j.length;g<h;g++)e=j[g],e.disconnect();return i=d.map(function(b){return e=y(function(){return a(b.get())})}),b.realSpliceCells(f,k.length,i)}}(this)),b},a.prototype.transform=function(a,b){return new f(function(b){return function(){return a(b.all())}}(this),b)},a.prototype.filter=function(a){return this.transform(function(b){return b.filter(a)})},a.prototype.slice=function(a,b){return this.transform(function(c){return c.slice(a,b)})},a.prototype.reduce=function(a,b){return this.all().reduce(a,null!=b?b:this.at(0))},a.prototype.reduceRight=function(a,b){return this.all().reduceRight(a,null!=b?b:this.at(0))},a.prototype.every=function(a){return this.all().every(a)},a.prototype.some=function(a){return this.all().some(a)},a.prototype.indexOf=function(a,b){return null==b&&(b=0),this.all().indexOf(a,b)},a.prototype.lastIndexOf=function(a,b){return null==b&&(b=this.length()-1),this.all().lastIndexOf(a,b)},a.prototype.join=function(a){return null==a&&(a=","),this.all().join(a)},a.prototype.first=function(){return this.at(0)},a.prototype.last=function(){return this.at(this.length()-1)},a.prototype.indexed=function(){return null==this.indexed_&&(this.indexed_=new k,W.autoSub(this.onChangeCells,function(a){return function(b){var c,d,e;return d=b[0],e=b[1],c=b[2],a.indexed_.realSpliceCells(d,e.length,c)}}(this))),this.indexed_},a.prototype.concat=function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],W.concat.apply(W,[this].concat(b.call(a)))},a.prototype.realSpliceCells=function(a,b,c){var d,e,f;return e=this.cells.splice.apply(this.cells,[a,b].concat(c)),f=W.snap(function(){var a,b,c,d;for(c=[],a=0,b=e.length;a<b;a++)d=e[a],c.push(d.get());return c}),d=W.snap(function(){var a,b,d,e;for(d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(e.get());return d}),this.onChangeCells.pub([a,e,c]),this.onChange.pub([a,f,d])},a.prototype.realSplice=function(a,b,c){return this.realSpliceCells(a,b,c.map(W.cell))},a.prototype._update=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(null==b&&(b=this.diff),i=W.snap(function(a){return function(){var b,c,d,e,f;for(d=a.cells,e=[],b=0,c=d.length;b<c;b++)f=d[b],e.push(f.get());return e}}(this)),e=[0,i.length,a],null,m=null!=b&&null!=(j=Q(i.length,a,b(i,a)))?j:[e],k=[],g=0,h=m.length;g<h;g++)l=m[g],f=l[0],d=l[1],c=l[2],k.push(this.realSplice(f,d,c));return k},a}(),s=W.SrcArray=function(d){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,d),e.prototype.spliceArray=function(a,b,c){return V.mutating(function(d){return function(){return d.realSplice(a,b,c)}}(this))},e.prototype.splice=function(){var a,c,d;return d=arguments[0],c=arguments[1],a=3<=arguments.length?b.call(arguments,2):[],this.spliceArray(d,c,a)},e.prototype.insert=function(a,b){return this.splice(b,0,a)},e.prototype.remove=function(b){var c;if(c=a(this.raw()).indexOf(b),c>=0)return this.removeAt(c)},e.prototype.removeAll=function(b){return W.transaction(function(c){return function(){var d,e;for(d=a(W.snap(function(){return c.all()})).indexOf(b),e=[];d>=0;)c.removeAt(d),e.push(d=a(W.snap(function(){return c.all()})).indexOf(b));return e}}(this))},e.prototype.removeAt=function(a){var b;return b=W.snap(function(b){return function(){return b.at(a)}}(this)),this.splice(a,1),b},e.prototype.push=function(a){return this.splice(W.snap(function(a){return function(){return a.length()}}(this)),0,a)},e.prototype.pop=function(){return this.removeAt(W.snap(function(a){return function(){return a.length()-1}}(this)))},e.prototype.put=function(a,b){return this.splice(a,1,b)},e.prototype.replace=function(a){return this.spliceArray(0,W.snap(function(a){return function(){return a.length()}}(this)),a)},e.prototype.unshift=function(a){return this.insert(a,0)},e.prototype.shift=function(){return this.removeAt(0)},e.prototype.update=function(a){return V.mutating(function(b){return function(){return b._update(a)}}(this))},e.prototype.move=function(a,b){return W.transaction(function(c){return function(){var d,e;if(a!==b){if(d=W.snap(function(){return c.length()}),a<0||a>d-1)throw"Source "+a+" is outside of bounds of array of length "+d;if(b<0||b>d)throw"Destination "+b+" is outside of bounds of array of length "+d;e=W.snap(function(){return c.all()[a]}),a>b?(c.removeAt(a),c.insert(e,b)):(c.insert(e,b),c.removeAt(a))}}}(this))},e.prototype.swap=function(a,b){return W.transaction(function(c){return function(){var d,e,f;if(e=W.snap(function(){return c.length()}),a<0||a>e-1)throw"i1 "+a+" is outside of bounds of array of length "+e;if(b<0||b>e-1)throw"i2 "+b+" is outside of bounds of array of length "+e;return d=Math.min(a,b),f=Math.max(a,b),c.move(d,f),c.move(f,d)}}(this))},e.prototype.reverse=function(){return this.update(W.snap(function(a){return function(){return a.all().reverse()}}(this))),W.snap(function(a){return function(){return a.all()}}(this))},e}(m),l=W.MappedDepArray=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b}(m),k=W.IndexedDepArray=function(d){function e(b,c){var d,f;null==b&&(b=[]),e.__super__.constructor.call(this,b,c),this.is=function(){var a,b,c,e;for(c=this.cells,e=[],d=a=0,b=c.length;a<b;d=++a)f=c[d],e.push(W.cell(d));return e}.call(this),this.onChangeCells=new j(function(b){return function(){return[[0,[],a.zip(b.cells,b.is)]]}}(this)),this.onChange=new j(function(b){return function(){return[[0,[],a.zip(W.snap(function(){return b.all()}),b.is)]]}}(this))}return c(e,d),e.prototype.map=function(a){var b;return b=new l,W.autoSub(this.onChangeCells,function(c){return function(c){var d,e,f,g,h,i,j,k,l,m;for(g=c[0],m=c[1],d=c[2],l=b.cells.slice(g,g+m.length),i=0,j=l.length;i<j;i++)e=l[i],e.disconnect();return k=function(){var b,c,g,i;for(i=[],b=0,c=d.length;b<c;b++)g=d[b],h=g[0],f=g[1],i.push(e=y(function(){return a(h.get(),f)}));return i}(),b.realSpliceCells(g,m.length,k)}}(this)),b},e.prototype.realSpliceCells=function(c,d,e){var f,g,h,i,j,k,l,m,n,o;for(n=this.cells.splice.apply(this.cells,[c,d].concat(e)),o=W.snap(function(){var a,b,c,d;for(c=[],a=0,b=n.length;a<b;a++)d=n[a],c.push(d.get());return c}),l=this.is.slice(c+d),k=h=0,i=l.length;h<i;k=++h)g=l[k],g.set(c+e.length+k);return j=function(){var a,b,d;for(d=[],g=a=0,b=e.length;0<=b?a<b:a>b;g=0<=b?++a:--a)d.push(W.cell(c+g));return d}(),(m=this.is).splice.apply(m,[c,d].concat(b.call(j))),f=W.snap(function(){var a,b,c,d;for(c=[],a=0,b=e.length;a<b;a++)d=e[a],c.push(d.get());return c}),this.onChangeCells.pub([c,n,a.zip(e,j)]),this.onChange.pub([c,o,a.zip(f,j)])},e}(m),W.IndexedMappedDepArray=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b}(k),f=W.DepArray=function(a){function b(a,c){this.f=a,b.__super__.constructor.call(this,[],c),W.autoSub(y(function(a){return function(){return a.f()}}(this)).onSet,function(a){return function(b){var c;return b[0],c=b[1],a._update(c)}}(this))}return c(b,a),b}(m),W.IndexedArray=function(a){function b(a){this.xs=a}return c(b,a),b.prototype.map=function(a){var b;return b=new l,W.autoSub(this.xs.onChange,function(c){var d,e,f;return e=c[0],f=c[1],d=c[2],b.realSplice(e,f.length,d.map(a))}),b},b}(f),W.concat=function(){var a,c,d,e,f;return e=1<=arguments.length?b.call(arguments,0):[],f=new l,a=e.map(function(a){return X.cast(a,"array")}),c=function(){var a,b,c;for(c=[],a=0,b=e.length;a<b;a++)d=e[a],c.push(0);return c}(),a.forEach(function(a,b){return W.autoSub(a.onChange,function(a){var d,e,g,h;return e=a[0],g=a[1],d=a[2],h=_(c.slice(0,b)),c[b]+=d.length-g.length,f.realSplice(h+e,g.length,d)})}),f},O=function(b){return b instanceof Map?b:a.isArray(b)?new Map(b):new Map(a.pairs(b))},fa=function(a,c){return new Set(b.call(a).concat(b.call(c)))},F=function(a,b){return new Set(Array.from(a).filter(function(a){return b.has(a)}))},A=function(a,b){return new Set(Array.from(a).filter(function(a){return!b.has(a)}))},o=W.ObsMap=function(){function b(a){this.x=null!=a?a:new Map,this.x=O(this.x),this.onAdd=new j(function(a){return function(){return[new Map(a.x)]}}(this)),this.onRemove=new j(function(a){return function(){return[new Map]}}(this)),this.onChange=new j(function(a){return function(){return[new Map]}}(this))}return b.prototype.get=function(a){return V.sub(function(b){return function(c){return W.autoSub(b.onAdd,function(b){if(b.has(a))return c.refresh()})}}(this)),V.sub(function(b){return function(c){return W.autoSub(b.onChange,function(b){if(b.has(a))return c.refresh()})}}(this)),V.sub(function(b){return function(c){return W.autoSub(b.onRemove,function(b){if(b.has(a))return c.refresh()})}}(this)),this.x.get(a)},b.prototype.has=function(a){return V.sub(function(b){return function(c){return W.autoSub(b.onAdd,function(b){if(b.has(a))return c.refresh()})}}(this)),V.sub(function(b){return function(c){return W.autoSub(b.onChange,function(b){if(b.has(a))return c.refresh()})}}(this)),V.sub(function(b){return function(c){return W.autoSub(b.onRemove,function(b){if(b.has(a))return c.refresh()})}}(this)),this.x.has(a)},b.prototype.all=function(){return V.sub(function(a){return function(b){return W.autoSub(a.onAdd,function(){return b.refresh()})}}(this)),V.sub(function(a){return function(b){return W.autoSub(a.onChange,function(){return b.refresh()})}}(this)),V.sub(function(a){return function(b){return W.autoSub(a.onRemove,function(){return b.refresh()})}}(this)),this.x},b.prototype.size=function(){return V.sub(function(a){return function(b){return V.sub(function(b){return W.autoSub(a.onRemove,function(){return b.refresh()})}),V.sub(function(b){return W.autoSub(a.onAdd,function(){return b.refresh()})}),a.x.size}}(this))},b.prototype.realPut=function(a,b){var c;return this.x.has(a)?(c=this.x.get(a),c!==b&&(this.x.set(a,b),this.onChange.pub(new Map([[a,[c,b]]]))),c):(this.x.set(a,b),void this.onAdd.pub(new Map([[a,b]])))},b.prototype.realRemove=function(a){var b;return b=I(this.x,a),this.onRemove.pub(new Map([[a,b]])),b},b.prototype._update=function(b){var c,d,e,f,g;return e=O(b),g=new Map(this.x),f=function(b){return function(){return a.chain(Array.from(b.x.keys())).difference(Array.from(e.keys())).map(function(a){return[a,I(b.x,a)]}).value()}}(this)(),c=function(b){return function(){return a.chain(Array.from(e.keys())).difference(Array.from(b.x.keys())).map(function(a){var c;return c=e.get(a),b.x.set(a,c),[a,c]}).value()}}(this)(),d=function(b){return function(){return a.chain(Array.from(e)).filter(function(a){var c,d;return c=a[0],d=a[1],b.x.has(c)&&b.x.get(c)!==d}).map(function(a){var c,d,e;return c=a[0],e=a[1],d=b.x.get(c),b.x.set(c,e),[c,[d,e]]}).value()}}(this)(),f.length&&this.onRemove.pub(new Map(f)),c.length&&this.onAdd.pub(new Map(c)),d.length&&this.onChange.pub(new Map(d)),g},b}(),u=W.SrcMap=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.put=function(a,b){return V.mutating(function(c){return function(){return c.realPut(a,b)}}(this))},b.prototype.set=function(a,b){return this.put(a,b)},b.prototype.delete=function(a){return V.mutating(function(b){return function(){var c;return c=void 0,b.x.has(a)&&(c=b.realRemove(a),b.onRemove.pub(new Map([[a,c]]))),c}}(this))},b.prototype.remove=function(a){return this.delete(a)},b.prototype.clear=function(){return V.mutating(function(a){return function(){var b;return b=new Map(a.x),a.x.clear(),b.size&&a.onRemove.pub(b),b}}(this))},b.prototype.update=function(a){return V.mutating(function(b){return function(){return b._update(a)}}(this))},b}(o),W.DepMap=function(a){function b(a){var c;this.f=a,b.__super__.constructor.call(this),c=new g(this.f),c.refresh(),W.autoSub(c.onSet,function(a){return function(b){var c;return b[0],c=b[1],a._update(O(c))}}(this))}return c(b,a),b}(o),P=function(a){return a instanceof Set?a:new Set(a)},w=function(a){return a instanceof Set||a instanceof p&&(a=a.all()),a instanceof m&&(a=a.all()),a instanceof n&&(a=a.get()),new Set(a)},p=W.ObsSet=function(){function a(a){this._x=null!=a?a:new Set,this._x=P(this._x),this.onChange=new j(function(a){return function(){return[[a._x,new Set]]}}(this))}return a.prototype.has=function(a){return V.sub(function(b){return function(c){return W.autoSub(b.onChange,function(b){var d,e;if(d=b[0],e=b[1],d.has(a)||e.has(a))return c.refresh()})}}(this)),this._x.has(a)},a.prototype.all=function(){return V.sub(function(a){return function(b){return W.autoSub(a.onChange,function(){return b.refresh()})}}(this)),this._x},a.prototype.values=function(){return this.all()},a.prototype.entries=function(){return this.all()},a.prototype.size=function(){return V.sub(function(a){return function(b){return W.autoSub(a.onChange,function(a){var c,d;if(c=a[0],d=a[1],c.size!==d.size)return b.refresh()})}}(this)),this._x.size},a.prototype.union=function(a){return new i(function(b){return function(){return fa(b.all(),w(a))}}(this))},a.prototype.intersection=function(a){return new i(function(b){return function(){return F(b.all(),w(a))}}(this))},a.prototype.difference=function(a){return new i(function(b){return function(){return A(b.all(),w(a))}}(this))},a.prototype.symmetricDifference=function(a){return new i(function(b){return function(){var c;return c=b.all(),a=w(a),new Set(Array.from(fa(c,a)).filter(function(b){return!c.has(b)||!a.has(b)}))}}(this))},a.prototype._update=function(a){return W.transaction(function(b){return function(){var c,d,e,f;return e=new Set(b._x),d=P(a),c=new Set,f=new Set,e.forEach(function(a){if(!d.has(a))return f.add(a)}),d.forEach(function(a){if(!e.has(a))return c.add(a)}),e.forEach(function(a){return b._x.delete(a)}),d.forEach(function(a){return b._x.add(a)}),b.onChange.pub([c,f]),e}}(this))},a}(),v=W.SrcSet=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.add=function(a){return V.mutating(function(b){return function(){return b._x.has(a)||(b._x.add(a),b.onChange.pub([new Set([a]),new Set])),a}}(this))},b.prototype.put=function(a){return this.add(a)},b.prototype.delete=function(a){return V.mutating(function(b){return function(){return b._x.has(a)&&(b._x.delete(a),b.onChange.pub([new Set,new Set([a])])),a}}(this))},b.prototype.remove=function(a){return this.delete(a)},b.prototype.clear=function(){return V.mutating(function(a){return function(){var b;return b=new Set(a._x),a._x.size&&(a._x.clear(),a.onChange.pub([new Set,b])),b}}(this))},b.prototype.update=function(a){return V.mutating(function(b){return function(){return b._update(a)}}(this))},b}(p),i=W.DepSet=function(a){function b(a){var c;this.f=a,b.__super__.constructor.call(this),c=new g(this.f),c.refresh(),W.autoSub(c.onSet,function(a){return function(b){var c;return b[0],c=b[1],a._update(P(c))}}(this))}return c(b,a),b}(p),W.cellToSet=function(a){return new W.DepSet(function(){return this.done(this.record(function(){return a.get()}))})},W.liftSpec=function(b){var c,d,e;return a.object(function(){var f,g,h,i;for(h=Object.getOwnPropertyNames(b),i=[],f=0,g=h.length;f<g;f++)c=h[f],e=b[c],null!=e&&[W.ObsMap,W.ObsCell,W.ObsArray,W.ObsSet].some(function(a){return e instanceof a})||(d=a.isFunction(e)?null:a.isArray(e)?"array":e instanceof Map?"map":e instanceof Set?"set":"cell",i.push([c,{type:d,val:e}]));return i}())},W.lift=function(b,c){var d,e,f;null==c&&(c=W.liftSpec(b));for(e in c)f=c[e],a.some(function(){var a,c,f,g;for(f=[n,m,o],g=[],a=0,c=f.length;a<c;a++)d=f[a],g.push(b[e]instanceof d);return g}())||(b[e]=function(){switch(f.type){case"cell":return W.cell(b[e]);case"array":return W.array(b[e]);case"map":return W.map(b[e]);case"set":return W.set(b[e]);default:return b[e]}}());return b},W.unlift=function(b){var c,d;return a.object(function(){var a;a=[];for(c in b)d=b[c],a.push([c,d instanceof W.ObsCell?d.get():d instanceof W.ObsArray?d.all():d]);return a}())},W.reactify=function(c,d){var e,f,g,h;return a.isArray(c)?(e=W.array(a.clone(c)),Object.defineProperties(c,a.object(function(){var d,g,h,i;for(h=a.functions(e),i=[],d=0,g=h.length;d<g;d++)f=h[d],"length"!==f&&i.push(function(a){var d,f,g;return d=c[a],f=function(){var f,g,h;return f=1<=arguments.length?b.call(arguments,0):[],null!=d&&(h=d.call.apply(d,[c].concat(b.call(f)))),(g=e[a]).call.apply(g,[e].concat(b.call(f))),h},g={configurable:!0,enumerable:!1,value:f,writable:!0},[a,g]}(f));return i}())),c):Object.defineProperties(c,a.object(function(){var a;a=[];for(g in d)h=d[g],a.push(function(a,c){var d,e,f,g,h;switch(d=null,c.type){case"cell":e=W.cell(null!=(f=c.val)?f:null),d={configurable:!0,enumerable:!0,get:function(){return e.get()},set:function(a){return e.set(a)}};break;case"array":h=W.reactify(null!=(g=c.val)?g:[]),d={configurable:!0,enumerable:!0,get:function(){return h.raw(),h},set:function(a){return h.splice.apply(h,[0,h.length].concat(b.call(a))),h}};break;default:throw new Error("Unknown observable type: "+type)}return[a,d]}(g,h));return a}()))},W.autoReactify=function(b){var c,d,e;return W.reactify(b,a.object(function(){var f,g,h,i;for(h=Object.getOwnPropertyNames(b),i=[],f=0,g=h.length;f<g;f++)c=h[f],e=b[c],e instanceof o||e instanceof n||e instanceof m||(d=a.isFunction(e)?null:a.isArray(e)?"array":"cell",i.push([c,{type:d,val:e}]));return i}()))},a.extend(W,{cell:function(a){return new t(a)},array:function(a,b){return new s((null!=a?a:[]).map(W.cell),b)},map:function(a){return new u(a)},set:function(a){return new v(a)}}),W.flatten=function(b){return W.cellToArray(y(function(){var c;return c=X.cast([b],"array"),c.length()?a.chain(c.all()).map(D).flatten().filter(function(a){return null!=a}).value():[]}))},D=function(b){return b instanceof m?D(b.all()):b instanceof p?D(Array.from(b.values())):b instanceof n?D(b.get()):b instanceof Set?D(Array.from(b)):a.isArray(b)?b.map(function(a){return D(a)}):b},function(b){return a.flatten(b),W.cellToArray(y(function(){return a.flatten(b)}))},W.cellToArray=function(a,b){return new f(function(){return a.get()},b)},W.cellToMap=function(a){return new W.DepMap(function(){return this.done(this.record(function(){return a.get()}))})},W.basicDiff=function(a){return null==a&&(a=W.smartUidify),function(b,c){var d,e,f,g,h,i,j;for(g=J(function(){var c,e,f;for(f=[],d=c=0,e=b.length;c<e;d=++c)j=b[d],f.push([a(j),d]);return f}()),i=[],e=0,f=c.length;e<f;e++)j=c[e],i.push(null!=(h=g[a(j)])?h:-1);return i}},W.uidify=function(a){var b;return null!=(b=a.__rxUid)?b:Object.defineProperty(a,"__rxUid",{enumerable:!1,value:K()}).__rxUid},W.smartUidify=function(b){return a.isObject(b)?W.uidify(b):JSON.stringify(b)},Q=function(b,c,d){var e,f,g,h,i,j;if(!c.length)return null;if(h=function(){var a,b,c;for(c=[],a=0,b=d.length;a<b;a++)f=d[a],f>=0&&c.push(f);return c}(),a.some(function(){var a,b,c;for(c=[],f=a=0,b=h.length-1;0<=b?a<b:a>b;f=0<=b?++a:--a)c.push(h[f+1]-h[f]<=0);return c}()))return null;for(j=[],g=-1,f=0;f<d.length;){for(;f<d.length&&d[f]===g+1;)g+=1,f+=1;for(i={index:f,count:0,additions:[]};f<d.length&&d[f]===-1;)i.additions.push(c[f]),f+=1;e=f===d.length?b:d[f],i.count=e-(g+1),(i.count>0||i.additions.length>0)&&j.push([i.index,i.count,i.additions]),g=e,f+=1}return j},W.transaction=function(a){return z.transaction(a)},null!=d){d.fn.rx=function(a){var b,c,d,e;return d=this.data("rx-map"),null==d&&this.data("rx-map",d=J()),a in d?d[a]:d[a]=function(){switch(a){case"focused":return c=W.cell(this.is(":focus")),this.focus(function(){return c.set(!0)}),this.blur(function(){return c.set(!1)}),c;case"val":return e=W.cell(this.val()),this.change(function(a){return function(){return e.set(a.val())}}(this)),this.on("input",function(a){return function(){return e.set(a.val())}}(this)),e;case"checked":return b=W.cell(this.is(":checked")),this.change(function(a){return function(){return b.set(a.is(":checked"))}}(this)),b;default:throw new Error("Unknown reactive property type")}}.call(this)},X={},X.events={},X.events.enabled=!1,X.events.onElementChildrenChanged=new j,X.events.onElementAttrsChanged=new j,q=X.RawHtml=function(){function a(a){this.html=a}return a}(),C=["blur","change","click","dblclick","error","focus","focusin","focusout","hover","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","ready","resize","scroll","select","submit","toggle","unload"],aa=["click"],$=X.specialAttrs={init:function(a,b){return b.call(a)}},E=function(a){return $[a]=function(b,c){return b instanceof SVGElement&&e.call(aa,a)>=0?b.addEventListener(a,c):b[a](function(a){return c.call(b,a)})}};for(G=0,H=C.length;G<H;G++)B=C[G],E(B);U=["async","autofocus","checked","location","multiple","readOnly","selected","selectedIndex","tagName","nodeName","nodeType","ownerDocument","defaultChecked","defaultSelected"],T=a.object(function(){var a,b,c;for(c=[],a=0,b=U.length;a<b;a++)S=U[a],c.push([S,null]);return c}()),Z=function(a,b,c){return a instanceof SVGElement?a.setAttribute(b,c):"value"===b?a.val(c):b in T?a.prop(b,c):a.attr(b,c)},Y=function(b,c,d,e){return null==e&&(e=a.identity),d instanceof n?W.autoSub(d.onSet,function(a){var d;if(a[0],d=a[1],Z(b,c,e(d)),X.events.enabled)return X.events.onElementAttrsChanged.pub({$element:b,attr:c})}):Z(b,c,e(d))},M=function(b,c){return null==b&&null==c?[{},null]:b instanceof Object&&null!=c?[b,c]:null==c&&a.isString(b)||a.isNumber(b)||b instanceof Element||b instanceof SVGElement||b instanceof q||b instanceof d||a.isArray(b)||b instanceof n||b instanceof m||b instanceof p?[{},b]:[b,null]},ea=function(b){var c,e,f,g,h;for(h=[],e=0,f=b.length;e<f;e++)if(c=b[e],null!=c)if(a.isString(c)||a.isNumber(c))h.push(document.createTextNode(c));else if(c instanceof Element||c instanceof SVGElement)h.push(c);else if(c instanceof q){if(g=d(c.html),1!==g.length)throw new Error("RawHtml must wrap a single element");h.push(g[0])}else{if(!(c instanceof d))throw new Error("Unknown element type in array: "+c.constructor.name+" (must be string, number, Element, RawHtml, or jQuery objects)");if(1!==c.length)throw new Error("jQuery object must wrap a single element");h.push(c[0])}else h.push(void 0);return h},ga=function(b,c){var e;if(b.html&&b.html(""),null!=c){if(a.isArray(c))return e=ea(c),b.append(e),e;if(a.isString(c)||a.isNumber(c)||c instanceof Element||c instanceof SVGElement||c instanceof q||c instanceof d)return ga(b,[c]);throw new Error("Unknown type for element contents: "+c.constructor.name+" (accepted types: string, number, Element, RawHtml, jQuery object of single element, or array of the aforementioned)")}},X.mktag=function(b){return function(c,e){var f,g,h,i,j,k,l,o;k=M(c,e),f=k[0],g=k[1],h=d("<"+b+"/>"),l=a.omit(f,a.keys($));for(j in l)o=l[j],Y(h,j,o);null!=g&&(g instanceof m?W.autoSub(g.indexed().onChangeCells,function(a){var b,c,d,e,f,g,i,j,k,l;for(e=a[0],j=a[1],b=a[2],h.contents().slice(e,e+j.length).remove(),l=ea(b.map(function(a){var b;return b=a[0],a[1],W.snap(function(){return b.get()})})),e===h.contents().length?h.append(l):h.contents().eq(e).before(l),X.events.enabled&&(j.length||l.length)&&X.events.onElementChildrenChanged.pub({$element:h,type:"childrenUpdated",added:l,removed:ea(j.map(function(a){return W.snap(function(){return a.get()})}))}),k=[],f=0,g=b.length;f<g;f++)i=b[f],c=i[0],d=i[1],k.push(function(a,b){return W.autoSub(a.onSet,W.skipFirst(function(a){var c,d;if(a[0],d=a[1],c=W.snap(function(){return b.get()}),l=ea([d]),h.contents().eq(c).replaceWith(l),X.events.enabled)return X.events.onElementChildrenChanged.pub({$element:h,type:"childrenUpdated",updated:l})}))}(c,d));return k}):g instanceof n?W.autoSub(g.onSet,function(a){var b;if(a[0],b=a[1],ga(h,b),X.events.enabled)return X.events.onElementChildrenChanged.pub({$element:h,type:"rerendered"})}):ga(h,g));for(i in f)i in $&&$[i](h,f[i],f,g);return h}},
da=["html","head","title","base","link","meta","style","script","noscript","body","body","section","nav","article","aside","h1","h2","h3","h4","h5","h6","h1","h6","header","footer","address","main","main","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","dd","figure","figcaption","div","a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr","ins","del","img","iframe","embed","object","param","object","video","audio","source","video","audio","track","video","audio","canvas","map","area","area","map","svg","math","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","fieldset","legend","fieldset","label","input","button","select","datalist","optgroup","option","select","datalist","textarea","keygen","output","progress","meter","details","summary","details","menuitem","menu"],ba=["a","altglyph","altglyphdef","altglyphitem","animate","animatecolor","animatemotion","animatetransform","circle","clippath","color-profile","cursor","defs","desc","ellipse","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialgradient","rect","script","set","stop","style","svg","switch","symbol","text","textpath","title","tref","tspan","use","view","vkern"],ha=function(b,c){for(var d,e,f,g,h;b.firstChild;)b.removeChild(b.firstChild);if(a.isArray(c)){for(h=ea(c),g=[],d=0,e=h.length;d<e;d++)f=h[d],g.push(b.appendChild(f));return g}if(a.isString(c)||c instanceof SVGElement)return ha(b,[c]);throw console.error("updateSVGContents",b,c),"Must wrap contents "+c+" as array or string"},X.svg_mktag=function(b){return function(c,d){var e,f,g,h,i,j,k,l;j=M(c,d),e=j[0],f=j[1],g=document.createElementNS("http://www.w3.org/2000/svg",b),k=a.omit(e,a.keys($));for(i in k)l=k[i],Y(g,i,l);null!=f&&(f instanceof m?f.onChange.sub(function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o;for(c=a[0],l=a[1],b=a[2],d=0,k=l.length;0<=k?d<k:d>k;0<=k?++d:--d)g.removeChild(g.childNodes[c]);if(o=ea(b),c===g.childNodes.length){for(m=[],h=0,e=o.length;h<e;h++)i=o[h],m.push(g.appendChild(i));return m}for(n=[],j=0,f=o.length;j<f;j++)i=o[j],n.push(g.childNodes[c].insertBefore(i));return n}):f instanceof n?(f.x[0],f.onSet.sub(function(a){var b;return a[0],b=a[1],ha(g,b)})):ha(g,f));for(h in e)h in $&&$[h](g,e[h],e,f);return g}},X.tags=a.object(function(){var a,b,c;for(c=[],a=0,b=da.length;a<b;a++)ca=da[a],c.push([ca,X.mktag(ca)]);return c}()),X.svg_tags=a.object(function(){var a,b,c;for(c=[],a=0,b=ba.length;a<b;a++)ca=ba[a],c.push([ca,X.svg_mktag(ca)]);return c}()),X.rawHtml=function(a){return new q(a)},X.importTags=function(b){return function(c){return a(null!=c?c:b).extend(X.tags)}}(this),X.cast=function(b,c){var d,e,f;if(null==c&&(c="cell"),!a.isString(c))return e=b,f=c,a.object(function(){var a;a=[];for(d in e)b=e[d],a.push([d,f[d]?X.cast(b,f[d]):b]);return a}());switch(c){case"set":return b instanceof W.ObsSet?b:b instanceof W.ObsArray?new W.DepSet(function(){return b.all()}):b instanceof W.ObsCell?new W.DepSet(function(){return b.get()}):new W.DepSet(function(){return b});case"array":if(b instanceof W.ObsArray)return b;if(a.isArray(b))return new W.DepArray(function(){return b});if(b instanceof W.ObsSet)return new W.DepArray(function(){return Array.from(b.values())});if(b instanceof W.ObsCell)return new W.DepArray(function(){return b.get()});throw new Error("Cannot cast to array: "+b.constructor.name);case"cell":return b instanceof W.ObsCell?b:y(function(){return b});default:return b}},X.trim=d.trim,X.dasherize=function(a){return X.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},X.cssify=function(b){var c,d;return console.warn("cssify is deprecated; set the `style` property directly to a JSON object."),function(){var e;e=[];for(c in b)d=b[c],null!=d&&e.push(X.dasherize(c)+": "+(a.isNumber(d)?d+"px":d)+";");return e}().join(" ")},$.style=function(b,c){var d;return d=c instanceof n,W.autoSub(X.cast(c).onSet,function(c){var e;if(c[0],e=c[1],null==e||a.isString(e)?Z(b,"style",e):b.removeAttr("style").css(e),d&&X.events.enabled)return X.events.onElementAttrsChanged.pub({$element:b,attr:"style"})})},X.smushClasses=function(b){return a(b).chain().flatten().compact().value().join(" ").replace(/\s+/," ").trim()},$.class=function(b,c){return Y(b,"class",c,function(b){return a.isString(b)?b:X.smushClasses(b)})}}return W.rxt=X,W},function(a,b){var c,d,e,f,g;if(e=["underscore"],(f="undefined"!=typeof window)&&e.push("jquery"),null!=("undefined"!=typeof define&&null!==define?define.amd:void 0))return define(e,b);if(null!=("undefined"!=typeof module&&null!==module?module.exports:void 0))return c=f?require("jquery"):void 0,d=require("underscore"),require("es5-shim"),require("es6-shim"),g=b(d,c),module.exports=g;if(null!=a._&&null!=a.$)return a.rx=b(a._,a.$);throw"Dependencies are not met for reactive: _ and $ not found"}(this,a)}).call(this);
//# sourceMappingURL=reactive-coffee.min.js.map